
numbers,square,comma
colorlinks=true,linkcolor=black,urlcolor=blue,citecolor=blue
3.6pt plus 4pt
Bounding extreme values on attractorsusing sum-of-squares optimization,with application to the Lorenz attractorDavid GoluskinEmail: goluskin@uvic.caDepartment of Mathematics and Statistics, University of Victoria, CanadaWe describe methods for bounding extreme values of quantities on global attractors of differential dynamical systems. Such bounds apply, in particular, along every trajectory at sufficiently late times. The methods use Lyapunov functions to find absorbing sets that contain the global attractor, and the choice of Lyapunov function is optimized based on the quantity whose extreme value one aims to bound. When the governing equations and quantities of interest are polynomials, the optimization constraints require two polynomial expressions to be nonnegative. Enforcing this nonnegativity by requiring the expressions to be representable as sums of squares, we obtain a series of convex optimization problems that can be recast as semidefinite programs and solved computationally. This allows the construction of complicated polynomial Lyapunov functions. We apply these methods to the chaotic Lorenz attractor, bounding extreme values of various moments of the coordinates FORMULA  using Lyapunov functions of polynomial degrees up to 8. In all cases we obtain bounds that are sharp to three or more significant figures, most of which are much sharper than prior results. Some of the absorbing sets constructed also give precise localizations of the attractor as a whole.
Introduction
In many complex systems it is desirable to predict the magnitudes of extreme events – for instance, the maximum height of a rogue wave, or the greatest instantaneous force applied by a turbulent fluid flow. The present work considers extreme events in eventual behavior, as opposed to transient events that depend on initial conditions. In particular we consider systems governed by differential equations, especially those with chaotic or otherwise complicated attractors, and we bound the values that quantities of interest can assume on such attractors.
When solutions of a differential equation cannot be characterized exactly, a common way to estimate their eventual behavior is to find absorbing sets – subsets of phase space that all solutions eventually remain in and which therefore contain the global attractor. These sets can be used to estimate properties of the attractor, including extreme values of various quantities. Absorbing sets can be found using Lyapunov functions, as described below, but generally there exist an infinite number of such functions. A typical approach is to first construct one or several of the simplest possible Lyapunov functions, such as quadratic forms, and to then use them to estimate properties of the attractor. In the present work we reverse these two steps. After choosing an attractor property to estimate, the construction of the Lyapunov function that implies the sharpest bound is posed as an optimization problem. Each property of interest begets a corresponding optimal Lyapunov function.
The construction of optimal Lyapunov functions is difficult in general. Here we restrict attention to ordinary differential equations (ODEs) with polynomial righthand sides because then polynomial optimization methods can be used. In particular, we formulate sufficient conditions wherein certain polynomials must have sum-of-squares (SOS) representations. The resulting optimization problems with SOS constraints are then solved numerically by recasting them as semidefinite programs (SDPs) – a well studied type of convex optimization problem {{cite:7de0fd35-783c-4c45-bd5d-c4b7e5547f05}}. The use of SDPs to solve SOS optimization problems has become standard since being pointed out nearly two decades ago {{cite:0f67b683-0490-4323-91a5-660ff310daad}}, {{cite:0ba9fef8-f080-4254-b0af-1c4b79c82a27}}, {{cite:0cdc49cb-8cca-4408-9a79-fcfccda25a0b}} and has found numerous applications in dynamics and control of ODE systems. These include the construction of Lyapunov functions to show that a solution is attracting, or to approximate a basin of attraction {{cite:0f67b683-0490-4323-91a5-660ff310daad}}, {{cite:c7dc7ed8-f26c-47bc-9609-00815e138a6c}}, {{cite:a9aac00b-8328-4081-93e2-f86303a73658}}, {{cite:97831392-5ede-47b8-ab6b-5b76d3787e83}}, {{cite:86e689c9-4a4f-4af9-b317-66455d9c5168}}, {{cite:8de6ebce-2211-48c6-b2eb-b943f8a02481}}, {{cite:4ef3760c-1391-477e-84a5-41c49bc99317}}, {{cite:39f4f596-cb38-453c-9e3e-e382e69e617b}}, as well as related methods for bounding infinite-time averages {{cite:802092cf-d186-40f9-ac79-56d6e22442bd}}, {{cite:d1574b75-b09d-44f5-83e5-fcb906ac3a81}}, {{cite:24964cb7-abe6-4aef-abd3-4841b0c52119}}. Some progress has been made applying SOS methods to nonlinear PDEs also {{cite:a1557395-c4c3-4a7d-abcc-39e4ad5e1e24}}, {{cite:c34223d0-4cb0-42ce-bc83-2aea0ac2935c}}, {{cite:7ff3e5d6-47bc-4ace-95dc-bf1d8f7cddc0}}. These works are similar in spirit to our present method, which was suggested but not applied in {{cite:7ff3e5d6-47bc-4ace-95dc-bf1d8f7cddc0}}, but they are not the same. As far as we know, the present study is the first to construct Lyapunov functions by optimizing the bounds that they imply.
Section  formulates a convex optimization framework for bounding extreme values on attractors, including an SOS-based version of this framework in cases where all quantities are polynomial. Section  reports computational results for the example of the Lorenz attractor. In particular, we bound extreme values of various moments – monomials of the coordinate variables (FORMULA , FORMULA , FORMULA ). The method appears to produce arbitrarily sharp bounds as the polynomial degree of Lyapunov functions is raised. For all moments considered here, our bounds on extreme values are sharp to three or more significant figures. All of these bounds are substantially sharper than previously reported estimates, aside from the well known lower bound FORMULA  which is sharp already. These results complement the similarly sharp bounds on infinite-time averages in the Lorenz system that we obtained by SOS methods in {{cite:24964cb7-abe6-4aef-abd3-4841b0c52119}}.

Optimizing bounds over classes of Lyapunov functions
Consider an autonomous ODE system,
FORMULA 
that is well-posed for any initial condition FORMULA . Assume that all trajectories FORMULA  are continuously differentiable and eventually remain in a bounded subset of FORMULA . The latter can be proved by the Lyapunov function methods used in this work. The global attractor FORMULA  of (REF ) can be defined as the maximal subset of FORMULA  that is invariant under the dynamics, or equivalently as the minimal set that attracts all initial conditions in every bounded subset of FORMULA  {{cite:f86c56c8-004d-4ebe-9c56-e7a6e677619b}}.
Let FORMULA  denote a quantity of interest in the model (REF ). Our present objective is to bound the maximum and minimum values of FORMULA  over the global attractor FORMULA ,
FORMULA 

Our objective is to compute upper bounds on FORMULA  and lower bounds on FORMULA . Such results also bound values of FORMULA  along all trajectories FORMULA  at sufficiently late times since the forward-time limit points of the system are a subset of the global attractor and thus
FORMULA 
We discuss only upper bounds without loss of generality; lower bounds on FORMULA  are equivalent to upper bounds on FORMULA .
We bound FORMULA  by constructing absorbing sets. Every absorbing set contains FORMULA , so the maximum of FORMULA  over any absorbing set is an upper bound on FORMULA . Like many authors, we find absorbing sets using continuously differentiable Lyapunov functions, FORMULA . Recalling that FORMULA  along all trajectories of (REF ), we seek FORMULA  satisfying
FORMULA 
throughout FORMULA  for some FORMULA  and FORMULA . Applying Gronwall's lemma to (REF ) gives FORMULA . Therefore the set
FORMULA 
is absorbing, and so
FORMULA 
For complicated FORMULA  it can be prohibitively difficult to evaluate the righthand maximum. We avoid this difficulty by adding a second constraint on FORMULA : we require not only (REF ) but also FORMULA  on all of FORMULA . Both inequalities together imply the upper bound FORMULA . Then it is natural to seek the best upper bound that can be proved using Lyapunov functions within some class FORMULA :
FORMULA 
The optimization (REF ) is convex in FORMULA  for each fixed value of FORMULA , as long as FORMULA  is a convex set of functions. This convexity makes it tractable to optimize bounds in certain cases, which is why we favor the inequalities in (REF ) over other sufficient conditions for FORMULA . Many previous authors have taken a different approach, choosing a particular function or simple ansatz for FORMULA  at the start of their analyses. With FORMULA  so fixed, one can use more complicated sufficient conditions that might give absorbing sets FORMULA  with smaller values of FORMULA  than can be obtained using (REF ).One weaker sufficient condition is to let FORMULA  be the maximum of FORMULA  on the set where FORMULA  vanishes {{cite:c5eb1849-75ee-4093-a81f-fad8c596458b}}. This amounts to imposing (REF ) on that set instead of on FORMULA ; the value FORMULA  is attained at a stationary point of the Lagrangian FORMULA  with FORMULA  being a Lagrange multiplier. Furthermore, constraints on FORMULA  can be restricted to subsets of FORMULA  already known to be absorbing, and various absorbing sets can be intersected to produce a smaller absorbing set.
Nonetheless, there are many cases in the literature where the best bounds on extreme values are not close to being sharp. We propose that better bounds can be obtained by considering larger classes of Lyapunov functions, even with suboptimal sufficient conditions. This is borne out by the bounds for the Lorenz attractor that we report in the next section.
Optimization over Lyapunov functions as in (REF ) can be carried out by methods of polynomial optimization if the ODE righthand side FORMULA  and quantity of interest FORMULA  are both polynomials. Henceforth we assume this is the case, and we let the class of Lyapunov functions be the set of real polynomials in FORMULA  variables up to a specified degree FORMULA  – that is, FORMULA . The inequalities in (REF ) then require nonnegativity of two multivariable polynomials. Deciding whether a polynomial is nonnegative has NP-hard computational complexity unless FORMULA  or FORMULA  is small {{cite:81ca1682-3569-4653-96a9-0e22af22e194}}, and we want to optimize among higher-degree Lyapunov functions for which such computations would be intractable. Thus we employ a standard SOS relaxation, replacing nonnegativity of a polynomial with the generally stronger constraint that the polynomial can be represented as a sum of squares of other polynomials {{cite:703e24b3-3875-47a4-9227-389ce4b9631a}}. The resulting SOS optimization is
FORMULA 
where FORMULA  denotes the set of SOS polynomials in FORMULA  variables. The best bounds provable using this framework improve or remain unchanged as the degree FORMULA  of FORMULA  is raised. In the typical situation where FORMULA  has a higher polynomial degree than FORMULA , the first constraint in (REF ) requires that FORMULA  is even. The second constraint requires that the degree of FORMULA  is even also.
The inner minimization in (REF ) is equivalent to a semidefinite program (SDP) because the SOS constraints and optimization objective are linear in the tunable variables {{cite:703e24b3-3875-47a4-9227-389ce4b9631a}}. This linearity is why we do not optimize over FORMULA  simultaneously, instead tuning FORMULA  and the coefficients of FORMULA  with FORMULA  fixed. The outer minimization might be difficult in some cases since the dependence of the inner minimum on FORMULA  need not be convex or even continuous. It is only a one-dimensional search, however, and at least for the Lorenz attractor we find simple dependence on FORMULA .

Bounds for the Lorenz attractor
To test the quality of bounds computed using (REF ) we consider the Lorenz equations {{cite:d8f7ac41-0d71-4ff8-86f0-222e671f4e42}}, in which case the components of the generic ODE (REF ) are
FORMULA 
We consider only the standard chaotic parameter values FORMULA , at which there exists a strange attractor to which almost every trajectory tends {{cite:9690d33e-cc6d-48d7-bce0-ead88c9b28b2}}. Invariant structures embedded in this attractor include an equilibrium at the origin and an infinite number of periodic orbits, as well as their unstable manifolds {{cite:cf3e06ef-1003-4c62-8875-7e36f6a53708}}. The global attractor includes all such structures, as well as two nonzero equilibria at the points FORMULA , and their unstable manifolds.
We have computed bounds on extreme values of moments on the global attractor, meaning FORMULA  where the exponents are nonnegative integers. More general polynomial FORMULA  can be bounded just as easily. Bounds were computed by solving (REF ) as described above – sweeping through FORMULA  and solving the inner minimization as an SDP – with polynomial FORMULA  of even degrees up to 8. The ansätze for FORMULA  need not be fully general: the requirement that FORMULA  be of even degree requires that all highest-degree terms of FORMULA  take the form FORMULA  {{cite:33eb81e8-2cd1-4dc9-b449-505270a0b9a2}}, {{cite:24964cb7-abe6-4aef-abd3-4841b0c52119}}. For FORMULA  that are invariant under the symmetry FORMULA  of the Lorenz equations, we further find that optimal FORMULA  contain only symmetric monomials, as when bounding time averages by a related method {{cite:24964cb7-abe6-4aef-abd3-4841b0c52119}}. The software YALMIP {{cite:cf0cae23-5311-4884-8e1b-707ec809b51b}}, {{cite:2baa675d-4f70-4964-afb5-2c64ee90d35f}} was used to translate SOS formulations into SDPs, which were solved using Mosek {{cite:bd977bfc-cc09-429d-9901-80f3da64ce53}}. The ODE variables were rescale by FORMULA  to improve SDP conditioning as in {{cite:24964cb7-abe6-4aef-abd3-4841b0c52119}}, after which Mosek converged with relative infeasibilities below FORMULA  in all cases.
In order to judge the sharpness of our bounds we have sought extreme values of each FORMULA  among particular trajectories of the Lorenz system. Such a search might be impossible in more complicated systems, which is one motivation for our bounding approach, but it is possible here. Trajectories we examined include numerical integrations beginning from random initial conditions (with initial transients removed), numerical integration approximating the one-dimensional unstable manifold of the origin, and the many periodic orbits computed by Viswanth {{cite:9292df94-46b1-4acc-87a8-233607d2f8f1}}, {{cite:6cb46237-b84d-4062-bce0-a03e723bbfb8}}. It is on the origin or its unstable manifold that we find the largest and smallest values of each FORMULA , and the closeness of these values to our computed bounds suggests that they are indeed global extrema. Numerical integration from random initial conditions does not give very good approximations to these various extrema; integrating for FORMULA  times steps of size 0.005 gives values that share one or two significant figures with the true extrema, but no more.
FIGURE 
Bounds produced by the inner minimization problem in (REF ) depend on FORMULA  and the degree of FORMULA  in similar ways for all FORMULA  bounded here. As a typical example, Figure REF  shows this dependence for upper bounds on the maximum of FORMULA . For all FORMULA , our computations give finite bounds with degree-FORMULA  Lyapunov functions when FORMULA , and the bounds are convex in FORMULA  on these intervals. Thus it is not hard to optimize FORMULA  over these intervals, which apparently suffices to give arbitrarily sharp bounds as the degree of FORMULA  is raised. However, these findings on the dependence of FORMULA  on FORMULA  are particular to the Lorenz equations.For the Lorenz equations, terms in FORMULA  of the form FORMULA , FORMULA , and FORMULA  produce terms in FORMULA  of the form FORMULA , FORMULA , and FORMULA , respectively. The latter three coefficients must be nonnegative in order for the second constraint in (REF ) to hold. At the standard parameters this requires FORMULA  if FORMULA . In most cases we obtain finite bounds only when FORMULA , and thus only when FORMULA  also. An exception is the lower bound on FORMULA  with quadratic FORMULA , where finite bounds are possible with FORMULA  because FORMULA  does not include a FORMULA  term.
As an example of the absorbing sets FORMULA  that give the bounds on FORMULA  reported in Figure REF , let us consider quadratic and quartic FORMULA  at the seemingly optimal values of FORMULA  and FORMULA , respectively. Figure REF  shows the quadratic and quartic absorbing sets FORMULA , where FORMULA  and FORMULA  solve the inner minimization in (REF ) at the optimal FORMULA  values. Also shown in Figure REF  is a numerical approximation to the unstable manifold of the origin, which is part of the global attractor. Evidently the quartic absorbing set implies a much sharper upper bound on FORMULA  than the quadratic set does. Neither set localizes the whole attractor well. Surprisingly, some other absorbing sets constructed by solving (REF ) do localize the global attractor very well, despite this not being the optimization objective. Figure REF  shows one such FORMULA , which was constructed by optimizing upper bounds on FORMULA  using FORMULA  of degree 8. This may be the smallest absorbing set that has been reported for the Lorenz attractor. It would be harder to minimize the volume of FORMULA  directly because this volume does not have convex dependence on the coefficients of FORMULA .
FIGURE 
FIGURE 
For all moments FORMULA  considered here, we have computed bounds on extreme values over the Lorenz attractor that are either exactly sharp or very close to being so. For the example of upper bounds on FORMULA , this sharpness can be inferred from the quartic FORMULA  in Figure REF . Our upper bounds on FORMULA  and other moments up to cubic degree are given in Table REF , alongside the apparently maximal values found on the unstable manifold of the origin. For convenience the tabulated values are normalized by each quantity's magnitude at the nonzero fixed points FORMULA . At the standard parameters these normalized moments are
FORMULA 
Quadratic Lyapunov functions, to which many past studies have been confined, do not produce particularly good bounds. On the other hand, FORMULA  of degree 4 and 6 produce upper bounds for all 13 moments that are sharp to at least 2 and 4 significant figures, respectively.
TABLE 
TABLE 
As for lower bounds on minimum values over the Lorenz attractor, many can be anticipated without additional computation. Manifestly nonnegative moments such as FORMULA  attain their minima on the equilibrium at the origin. For moments that are antisymmetric under the symmetry FORMULA  of the Lorenz system, the upper bound FORMULA  implies the lower bound FORMULA . We thus compute lower bounds only for symmetric moments that are not obviously nonnegative. Table REF  reports our lower bounds on such moments up to cubic degree, computed by solving (REF ) for upper bounds on FORMULA . In all cases, the bounds appear to become sharp as the degree of FORMULA  is raised.
Complications arise with the lower bounds on FORMULA , FORMULA , and FORMULA  that do not arise in our other examples. These three quantities are minimized at the origin, whereas all other extrema we have bounded appear to occur elsewhere on the origin's unstable manifold. The sharp lower bound FORMULA  can be proved using the sufficient condition (REF ) with quadratic FORMULA  only if FORMULA , but a naive search over FORMULA  may not find this result since other FORMULA  values do not give finite bounds.With FORMULA , FORMULA , and FORMULA , the quadratic Lyapunov function FORMULA  satisfies (REF ) and thus proves the known result FORMULA . In the past this has been proved by showing that a condition like (REF ) holds on a compact set already known to be absorbing {{cite:cf3e06ef-1003-4c62-8875-7e36f6a53708}}, {{cite:8e7f9a03-849d-46b8-841b-92ae6ba9eb64}}, rather than on all of phase space.
Raising the degree of FORMULA  to FORMULA  removes this difficulty since then the optimal value FORMULA  falls in the interval FORMULA  on which the lower bound on FORMULA  is convex in FORMULA . The nonnegativity of FORMULA  on the Lorenz attractor implies that FORMULA  and FORMULA  are nonnegative also. However, as reflected in Table REF , we have not been able to prove exact lower bounds on FORMULA  and FORMULA  using the framework (REF ) alone.
Various bounds on coordinates of the Lorenz system have appeared in the literature, and bounds on other functions of FORMULA  can be inferred from known absorbing sets. The bounds reported in Tables REF  and REF  are sharper than the best results in the literature, except for the already sharp lower bound FORMULA . For the example of upper bounds on FORMULA  and FORMULA , the best prior results we know of are identical to the bounds we report in Table REF  for quadratic FORMULA ; both bounds follow from the fact that the cylinder FORMULA  is absorbing when FORMULA  {{cite:99c2e0aa-974f-4787-8a5d-0b7dd8f9b4ff}}, {{cite:3bb94d43-18f2-4ee4-94e6-ec3408dcfde3}}. These bounds exceed the true maxima of FORMULA  and FORMULA  by more than 4% and 17%, respectively, whereas the bounds we compute with quartic FORMULA  are much sharper. While most authors have considered only quadratic Lyapunov functions, some have suggested particular quartic functions {{cite:2f015276-3c25-404a-bcf5-4d3834bd1c3f}}, {{cite:c5eb1849-75ee-4093-a81f-fad8c596458b}}, {{cite:a50e1b50-467d-43bb-8f5d-db4a926bc18d}}. None of these quartic functions do as well as our optimized quartic FORMULA , although the quartic absorbing set of {{cite:a50e1b50-467d-43bb-8f5d-db4a926bc18d}} implies bounds on FORMULA  and FORMULA  that are slightly better than our quadratic-FORMULA  results.
Some results in the literature use analyses more complicated than the sufficient condition (REF ). The best prior upper bound on FORMULA  seems to be that of {{cite:5407ee03-2d62-4c83-89c2-663ea5f226d8}}, whose approach {{cite:846bbde4-b7fe-408f-8b1c-85f5e4c274ee}} is to first use a quadratic Lyapunov function to show that a certain ellipsoid is absorbing, and then use FORMULA  as a Lyapunov function on that ellipsoid. The resulting bound, normalized according to (REF ), is about 3.180. This is sharper than our quadratic-FORMULA  bound of 3.9317 but not our quartic-FORMULA  bound of 2.3378. Similarly, a large number of quadratic Lyapunov functions are constructed in {{cite:df767d01-abd1-44e0-b6af-9267bd504032}} using computer algebra, and the implied bounds are stronger than those of a single quadratic FORMULA  but weaker than those of quartic FORMULA . These results reflect the fact that the sufficient condition (REF ) is not the strongest possible. However, they also suggest that inferring the best possible bound from a particular FORMULA  is not as important as having a computationally tractable way to optimize FORMULA  beyond the quadratic case.

Conclusions
We have illustrated a method for bounding extreme values of quantities on global attractors. It involves constructing Lyapunov functions by solving convex optimization problems. When all quantities are polynomial, the optimization problems can be cast as semidefinite programs. Applied to the Lorenz attractor at the standard chaotic parameters, our approach produces very sharp bounds on all quantities considered. In most cases they are far sharper than the best results in the literature. The bounds appear to become arbitrarily sharp as the polynomial degree of the Lyapunov function is raised. This is also true of preliminary results for the Kuramoto–Sivashinsky equation that will be reported elsewhere.
A fundamental theoretical question is: under what conditions does the present method produce sharp bounds? In a related optimization framework for bounding infinite-time averages, it has been proved that arbitrarily sharp bounds are possible for differential equations under quite general assumptions {{cite:2452c31d-5564-47f4-814c-f4b5c2a44128}}. A similar result about the present method would ensure that our success with the Lorenz attractor is typical.
The present work represents yet another instance where methods based on polynomial optimization, when applicable, produce stronger results about dynamical systems than any other approach. Related methods have been similarly successful in demonstrating stability {{cite:0f67b683-0490-4323-91a5-660ff310daad}}, {{cite:c7dc7ed8-f26c-47bc-9609-00815e138a6c}}, {{cite:8de6ebce-2211-48c6-b2eb-b943f8a02481}}, bounding time averages {{cite:802092cf-d186-40f9-ac79-56d6e22442bd}}, {{cite:d1574b75-b09d-44f5-83e5-fcb906ac3a81}}, {{cite:24964cb7-abe6-4aef-abd3-4841b0c52119}}, and estimating basins of attraction {{cite:a9aac00b-8328-4081-93e2-f86303a73658}}, {{cite:97831392-5ede-47b8-ab6b-5b76d3787e83}}, {{cite:86e689c9-4a4f-4af9-b317-66455d9c5168}}, {{cite:8de6ebce-2211-48c6-b2eb-b943f8a02481}}, {{cite:4ef3760c-1391-477e-84a5-41c49bc99317}}, {{cite:39f4f596-cb38-453c-9e3e-e382e69e617b}}. For many other types of statements about dynamics, however, methods of proof that take advantage of polynomial optimization have not yet been devised. The development of such novel methods for ordinary differential equation is sure to remain a fruitful area of research, as is the challenge to extend these methods to partial differential equations.
Acknowledgements
The author thanks Giovanni Fantuzzi for valuable discussions while visiting the Geophysical Fluids Dynamics program at the Woods Hole Oceanographic Institution. This work was partially supported by an NSERC Discovery Grant.

Supplementary results
Tables REF  and REF  give the values of FORMULA  that appear to solve the outer minimization in (REF ). For these values, the inner minimization in (REF ) produces the upper and lower bounds reported in Tables REF  and REF , respectively. We believe these FORMULA  values are optimal but have not proved it. With the exception of the lower bound FORMULA  computed using quadratic FORMULA , all FORMULA  values fall in the intervals FORMULA  on which the bounds produced using degree-FORMULA  FORMULA  appear to have convex dependence on FORMULA .
TABLE 
TABLE 
